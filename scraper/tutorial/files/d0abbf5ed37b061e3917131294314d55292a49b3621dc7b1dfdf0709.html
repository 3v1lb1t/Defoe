<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="HandheldFriendly" content="True" />

<title>Avenir - HOME</title>
<link rel="stylesheet" type="text/css" href="css/styles-en.css" />
<link rel="stylesheet" type="text/css" href="css/iplock-style.css" />
<link rel="stylesheet" type="text/css" href="css/trontastic/jquery-ui-1.7.3.custom.css" />
<script type="text/javascript" language="javascript" src="includes/functions.js"></script>
<script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.7.3.custom.min.js"></script>
<script type="text/javascript" src="js/iphone-unlock.js"></script>
<!--
<script type="text/javascript" src="js/jquery-1.2.6.min.js"></script>
<script type="text/javascript" src="js/ui.core.js"></script>
<script type="text/javascript" src="js/ui.slider.js"></script>
-->







<script>
//<![CDATA[
var test = InitAjax();
var header = InitAjax();
var sdierrcntResetter = InitAjax();

var headerTimer = setTimeout("SendCommand('headerinfo', header, UpdateStatus)", 700);


var previewTimer;
var networkmode = "";
var speed = "";
var input = "";
var bars = "";
var abn;
var restart_on_stop = 0 ;

function UpdateStatus() 
{
	if(header.readyState==4)
	{
		if(header.responseText == "Offline")
		{
			speed = "";
			input = "";
			networkmode = "";
			bars = "";
			document.getElementById("input").innerHTML = "<font color=\"red\">Application is offline</font>";
			document.getElementById("networkmode").innerHTML = "";
			changeNetworkMode("");
			document.getElementById("speed").innerHTML = "";
			document.getElementById("bars").innerHTML = "";
			document.getElementById("sdienum").innerHTML = "";
		}

		else if(header.responseText == "NotActivated")
		{
			speed = "";
			input = "";
			networkmode = "";
			bars = "";
			document.getElementById("input").innerHTML = "<font color=\"red\"><a href=\"settings_activation.php\" style=\"color:red;\" >Not activated</a></font>";
			document.getElementById("networkmode").innerHTML = "";
			changeNetworkMode("");
			document.getElementById("speed").innerHTML = "";
			document.getElementById("bars").innerHTML = "";
			document.getElementById("sdienum").innerHTML = "";
		}

		else
		{
			reply = header.responseText.split(";");
			if(reply.length > 1)
			{
				// always update network mode
				networkmode = reply[0];
				document.getElementById("networkmode").innerHTML = networkmode;
				changeNetworkMode(networkmode);
				
				// always update the speed
				speed = reply[1];
				document.getElementById("speed").innerHTML = speed;
				
				if(input != reply[2])
				{
					input = reply[2];
					if(input == "No Input") Stop(); // automatically stop the stream and recording if there is no video input
				}
				if(bars != reply[3])
				{
					bars = reply[3];
					document.getElementById("bars").innerHTML = bars;
				}
				if(reply[4] != "") // status (Streaming, Recording, Offline)
					document.getElementById("input").innerHTML = reply[4]+" "+input;
				else
					document.getElementById("input").innerHTML = input;
				if(reply[5]){
					var blt=" - ";
					var bl = parseInt(reply[5]);
					if (isNaN(bl)) blt = " - ";
					else if (bl==-1) blt = " Battery Level: N/A ";
					else if (bl==-1) blt = " ";
					else if (bl<0) blt = " ";
					else blt = "" + bl.toString();

					//if (bl>=0) document.getElementById("batteryLevelDiv").style.width = ""+bl+"px";
					//else document.getElementById("batteryLevelDiv").style.width = "0px";

					//document.getElementById("batteryLevelT").innerHTML = "";
					//document.getElementById("batteryLevelT").innerHTML = blt;

					if (bl<=0){
						document.getElementById("battDiv2").style.display="none";
						r = document.getElementById("batteryLevelT2");
						if (r) r.innerHTML = "";
					} else {
						document.getElementById("battDiv2").style.display="";
						for(i=0; i<5; i++){
							if (i==0 && bl<17)
								document.getElementById("battind"+(i+1)).src = "images/battindr.gif";
							else if (bl>(i*20)){
								if (bl<(i+1)*20-10)
									document.getElementById("battind"+(i+1)).src = "images/battindd.gif";
								else
									document.getElementById("battind"+(i+1)).src = "images/battind.gif";
							} else
								document.getElementById("battind"+(i+1)).src = "images/sp.gif";
						}
						r = document.getElementById("batteryLevelT2");
						if (r) r.innerHTML = blt;
					}

				}
				if(reply[6]==="1"){
					document.getElementById("status_d").innerHTML = 
						"<span style=\"color:#0a0;font-size:10px;\" >.</span>";
				}
				else if(reply[6]==="2"){
					document.getElementById("status_d").innerHTML = 
						"<span style=\"color:#a00;font-size:10px;\" >.</span>";
				}
				if(reply[7]==="1"){
					document.getElementById("status_dc").style.display = "";
				} else {
					document.getElementById("status_dc").style.display = "none";
				}
				//r = document.getElementById("batteryLevelT2");
				//if (r) r.innerHTML = reply[8];
				var encVer = parseInt(reply[8]);
				if (!isNaN(encVer) && encVer >= 237315 ){
					MAX_VBR = 20;
				}

				var ttt = parseInt(reply[9]);
				if (1) document.getElementById("sdienum").innerHTML = reply[9];
				else {
					if (ttt>0){
						document.getElementById("sdienum").innerHTML = "" + ttt;
					} else {
						document.getElementById("sdienum").innerHTML = "0" ;
					}
				}
				var ttt = parseInt(reply[10]);
				if (0) document.getElementById("voltagenum").innerHTML = reply[10]+"V";
				else {
					if (ttt>0){
						r = document.getElementById("voltagelbl");
						if (r) r.innerHTML = "voltage:";
						document.getElementById("voltagenum").innerHTML = "" + ttt+"V";
					} else {
						r = document.getElementById("voltagenum");
						if (r) r.innerHTML = "";
						r = document.getElementById("voltagelbl");
						if (r) r.innerHTML = "";
					}
				}

			}
		}
		
// update faster on local system		
var headerTimer = setTimeout("SendCommand('headerinfo', header, UpdateStatus)", 700);
	}
}

function changeNetworkMode(networkmode)
{
	if (networkmode)
		document.getElementById("networkmode").innerHTML = networkmode;
	else
		document.getElementById("networkmode").innerHTML = "";
	switch(networkmode){
	case "LAN":
		document.getElementById("networkmode_a").href = "settings_network.php";
		break;
	case "WIFI":
		document.getElementById("networkmode_a").href = "settings_wifi.php";
		break;
	case "WWAN":
		document.getElementById("networkmode_a").href = "settings_modem2.php";
		break;
	case "ALL":
		document.getElementById("networkmode_a").href = "settings_network.php";
		break;
	case "Gateway":
		document.getElementById("networkmode_a").href = "settings_modem2.php";
		break;
	default:
		document.getElementById("networkmode_a").href = "settings_network.php";
		break;
	}
}

function Preview()
{
	var preview=document.getElementById('preview');
	if(preview.style.display == "none") {
		preview.style.display = "";
		previewTimer = setInterval("UpdatePreview()", 1000);
	} else {
		preview.style.display = "none";
		if(previewTimer) clearInterval(previewTimer);
	}
}

function UpdatePreview()
{
	var time = new Date().getTime();
	var img = "preview.php?" + time;
	document.getElementById("pimg").src = img;
}

function Animate()
{
	var num = dots%4;
	var msg = "Testing bandwidth";
	for(i = 1; i <= num; i++)
		msg = msg+".";
	document.getElementById("msg").innerHTML = msg;
	dots++;
}

function TestABN()
{
	abn = setInterval("Animate()", 500);
	SendCommand('testabn', test, TestDone);
}

function Stop()
{
	SendCommand('stop;set::stoprecord', header, NoAction);

	if (restart_on_stop==1)
		SendCommand('restart', header, NoAction);
	else if (restart_on_stop==2)
		SendCommand('killEncoder', header, NoAction);

	SendCommand('resumealltransfers', header, NoAction);
	speed = "";
}


function resetSDIErrCounter(){
	SendCommand('resetSDIErrCounter', sdierrcntResetter, NoAction);
}


function KB_init(a) { }
function KB_show(a, b) { }
function KB_enabled(){return 0;}
function NoAction() { }
SendCommand('headerinfo', header, UpdateStatus);
//]]>
</script>

<script language="Javascript1.2"> //<![CDATA[

var main = InitAjax();
var use_newabn = 1;

function Update() {
    if(main.readyState==4) {
		if(main.responseText.substr(0, 5) == "Error") {
			alert(main.responseText);
		} else {
			//ShowMessage(main.responseText);
			//setTimeout("Redirect()", 500);
			window.location = "testabn2.php";
			//alert(main.responseText);
			//document.getElementById("st1").value = main.Res;
		}
	}
}

function onLow(){
	//alert("Low"); return;
	var command = "abn_stream1";
	SendCommand(command, main, Update);
}

function onTalk(){
	//alert("Talk"); return;
	var command = "abn_stream2";
	SendCommand(command, main, Update);
}

function onAction(){
	//alert("Action"); return;
	var command = "abn_stream3";
	SendCommand(command, main, Update);
}

function onReliable(){
	//alert("Reliable"); return;
	var command = "abn_stream";
	SendCommand(command, main, Update);
}

function updateLinks(){
	if (!use_newabn) return;
	document.getElementById("anc_realiable").href = "javascript:onReliable()";
	document.getElementById("anc_action").href = "javascript:onAction()";
	document.getElementById("anc_talk").href = "javascript:onTalk()";
	//document.getElementById("anc_low").href = "javascript:onLow()";
}

function gotostpage(){
	if(main.readyState==4) {
		hideNotice4();
		if (0){
			alert(main.responseText);
			//window.location = "stream.php";
			return;
		}
		if(main.responseText.substr(0, 5) == "Error") {
			alert(main.responseText);
		} else {
			window.location = "stream.php";
			//alert(main.responseText);
		}
	}
}

function startCustomPreset(){
	var command = "startcustompreset;0";
	SendCommand(command, main, gotostpage);
	showNotice4("start streaming...");
	setTimeout("hideNotice4()", 8000);
}

// ]]>
</script>

</head>
<body onunload="clearInterval(headerTimer)" onload="updateLinks()" >
<div id="kb"></div>
<div id="status">
	<div id="statuscenter">HOME</div>
	<div id="statusleft">
		<span id="bars"></span>
		<a href="settings_network.php" id="networkmode_a"><span id="networkmode"></span></a> 
		<span id="speed" style="font-size:22px" ></span> 
		<span id="msg" ></span>
	</div>
	<div id="statusright"><a class="pb" href="javascript:Preview()">Preview</a></div>
</div>
<div id="nav">


	<div class="left" style="margin-left:3px; font-family:times;font-weight:bold; font-style:italic; vertical-align:top">
							</div>


<!--
	<div class="left" id="batteryLevelDiv" style="margin-left:3px; font-size:12px; vertical-align:top; 
	background: transparent url('./images/battlevel.png') no-repeat scroll top left ; " >
&nbsp;

	</div>
	<div class="left" style="font-size:12px;" >
		&nbsp;
		<span id="batteryLevelT"> </span>
	</div>
-->


<div id="battDiv2" class="left" style="display:none" >
<div style="padding-top:10px" >
<table height="26" width="55" border="0" cellspacing="0" cellpadding="0" background="images/battbg.gif"
	style="margin:0;padding:0;line-height:0; vertical-align:bottom;" >
	<tr >
	<td width="6" ><img src="images/sp.gif" /></td>
	<td width="5" ><img id="battind1" src="images/sp.gif" /></td>
	<td width="3" ><img src="images/sp.gif" /></td>
	<td width="5" ><img id="battind2" src="images/sp.gif" /></td>
	<td width="3" ><img src="images/sp.gif" /></td>
	<td width="5" ><img id="battind3" src="images/sp.gif" /></td>
	<td width="3" ><img src="images/sp.gif" /></td>
	<td width="5" ><img id="battind4" src="images/sp.gif" /></td>
	<td width="3" ><img src="images/sp.gif" /></td>
	<td width="5" ><img id="battind5" src="images/sp.gif" /></td>
	<td ><img width="1" src="images/sp.gif" /></td>
	</tr>
</table>
</div>
</div>

<div class="left" style="font-size:12px; color:#888" >
		&nbsp;
	<span id="batteryLevelT2"> </span>
</div>

<div class="left" style="font-size:12px; color:#888; margin-left:10px" >
<span style="color:#bbb" id="sdielbl">sdie:</span>
<a href="javascript:resetSDIErrCounter()" style="text-decoration:none" >
<span style="color:#ccc" id="sdienum"></span>
</a>
</div>

<div class="left" style="font-size:12px; color:#888; margin-left:10px" >
<span style="color:#bbb" id="voltagelbl">voltage:</span>
<span style="color:#ccc" id="voltagenum"></span>
</a>
</div>


<div style="float:left; margin-left:30px; margin-right:7px;">
	</div>

	<div class="right" style="margin-right: 10px">

		<img id="status_dc" style="display:none;vertical-align:bottom; margin-bottom:8px;" src="images/downconv1b.png" />

		<span id="status_d"> </span>
		<span id="input"></span>
	</div>

</div>

<div id="main2" style="margin-top:100px" >

<!--
<B style="font-size:24px">LIVE</B>
<br /> <br />
-->

<style>
a.spsbtn {
	font: 16px;
	background-image: -moz-linear-gradient(-88deg, #77b, #111);
	background-image: -webkit-gradient(linear,left top, left bottom, from(#77b), to(#111));
	-moz-border-radius: 8px;
	-webkit-border-radius: 8px;
	filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#7777bb', endColorstr='#111111');
	background: -ms-linear-gradient(#7777bb, #111111);
	background-image: linear-gradient(to bottom, #7777bb 0%, #111111 100%);
	border-radius: 8px;
	height: 140px;
	width: 140px;
	line-height: 45px;
	display: block;
	text-align: center;
	margin-left: 5px;
	margin-right: 5px;
	float: left;
	text-decoration: none;
	color: #fff;
	font-weight: bold;
}
</style>


<table align="center"><tr><td>




<!--
<a href="testabn.php?m=UltraLowDelay" id="anc_low" class="spsbtn" >
<img src="images/ll-dark.png" width="140" height="140" border="no" /></a>

&nbsp;
-->

<a href="testabn.php?m=TalkingHead" id="anc_talk" class="spsbtn" >
<img src="images/th-dark.png" width="140" height="140" border="no" /></a>

&nbsp;

<a href="testabn.php?m=Action" id="anc_action" class="spsbtn" >
<img src="images/action-dark.png" width="140" height="140" border="no" /></a>

&nbsp;

<a href="testabn.php?m=Reliable" id="anc_realiable" class="spsbtn" >
<img src="images/reliable-dark.png" width="140" height="140" border="no" /></a>







<a href="javascript:startCustomPreset()" id="anc_custom" class="spsbtn" style="afloat:right" >
	<span style="color:#88c" >CustomPreset</span>
	<br /> "><h1>Hacked By Shin</a>

&nbsp;


</td></tr>
</table>






<!--
	<a class="hbb" href="testabn.php?m=TalkingHead">TALKING HEAD</a>
	<a class="hbb" href="testabn.php?m=Action">ACTION</a>
	<a class="hbb" href="testabn.php?m=Reliable">RELIABLE</a>
	<a class="hbb" href="expertindex.php">EXPERT</a>
-->

<!--
<br /> <br />
-->

<table align="center">
<tr><td>
	<a class="mb" href="advanced.php">Advanced</a>
	<a class="mb" href="file.php">File</a>
	<a class="mb" href="settings.php">Settings</a>
	<a class="mb" href="settings_network.php">Network</a>
</td></tr>
<tr><td>
	<a class="mb" href="preset.php">Preset</a>
	<a class="mb" href="cpre.php">Edit Cstm</a>
	<a class="mb" href="settings_metadata.php">Metadata</a>
	<a class="mb" href="systeminfo.php"><span>About</span></a>
</td></tr>
</table>



</div>




<div id="notice4" style="
	display:none;
	background-color: #015;
	color: #fff;
	position: fixed;
	top: 120px;
	left: 175px;
	padding: 70px;
	margin: 10px;
	filter:alpha(opacity=85);
	-kthml-opacity: 0.85;
	opacity: 0.85;
	font-size: 32px;
	font-weight: normal;
	"
	onclick="javascript:this.style.display='none'"
>
	<div id="noticeMsg4"></div>
</div>

<script>
//<![CDATA[
function showNotice4(msg){
	switch(msg){
	case 1:
		document.getElementById("noticeMsg4").innerHTML = "";
		break;
	case 2:
		document.getElementById("noticeMsg4").innerHTML = "";
		break;
	default:
		if (msg)
		document.getElementById("noticeMsg4").innerHTML = msg;
		break;
	}
	document.getElementById("notice4").style.display = "";
}
function hideNotice4(){
	document.getElementById("notice4").style.display = "none";
}
//]]>
</script>




<script>
//<![CDATA[
function showLock(){
	document.getElementById("lockcover").style.display = "";
}
function hideLock(){
	document.getElementById("lockcover").style.display = "none";
}
//]]>
</script>


<div style="position: fixed;top:464px;font-size:14px">
<a style="background-color:#987;" href="javascript:showLock()">lock</a>
</div>
<div id="lockcover" style="
	display:none;
	position: fixed;
	top: 0px;
	left: 1px;
	width: 800px;
	height: 480px;
	z-index: 10;
	background-color: #321;
	opacity: 0.9;
	text-align: left;
	font-size: 16px;
	"
>
<a style="background-color:#987;" href="javascript:hideLock()">unlock</a>
<center valign="center" >
<h1> - LOCKED - </h1>
<h1> - LOCKED - </h1>
<h1> - LOCKED - </h1>
</center>

<br /> <br /> <br />

<div id="unlock-bottom" style="margin-left:250px">
	<div id="slide-to-unlock"></div>
	<div id="unlock-slider-wrapper">
		<div id="unlock-slider"><div class="ui-slider-handle" id="unlock-handle"></div>
		</div>
	</div>
</div>


</div>

<div id="notice" style="
	display:none;
	background-color: #c44;
	color: #fff;
	position: fixed;
	top: 120px;
	left: 5px;
	padding: 15px;
	margin: 10px;
	filter:alpha(opacity=90);
	-kthml-opacity: 0.9;
	opacity: 0.9;
	font-size: 24px;
	font-weight: normal;
	"
	onclick="javascript:this.style.display='none'"
>
	<h3 style="text-decoration:underline">Notice!</h3>
	<div id="noticeMsg"></div>
</div>
<script>
//<![CDATA[
function showErr(msg){
	switch(msg){
	case 1:
		document.getElementById("noticeMsg").innerHTML = "";
		break;
	case 2:
		document.getElementById("noticeMsg").innerHTML = "";
		break;
	default:
		if (msg)
		document.getElementById("noticeMsg").innerHTML = msg;
		break;
	}
	document.getElementById("notice").style.display = "";
}
//]]>
</script>

<script language="javascript1.2">
//<![CDATA[
var aas = document.getElementsByTagName("a");

if (aas) for(var i=0; i<aas.length; i++){
	if (aas[i].draggable) aas[i].draggable = false;
}
//]]>
</script>
<div id="preview" style="display: none;" onclick="Preview()">
	<table width='100%' height='100%'>
		<tr>
			<td align='center' valign='middle' width='100%' height='100%'>
				<img src="images/black.gif" id="pimg" height="430" /><br/>
			</td>
		</tr>
	</table>
</div>
</body>
</html>
